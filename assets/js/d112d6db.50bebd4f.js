"use strict";(self.webpackChunksubway_builder_modded_docs=self.webpackChunksubway_builder_modded_docs||[]).push([[939],{9930(e,n,t){t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>r,default:()=>u,frontMatter:()=>c,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"project-structure","title":"Project Structure","description":"Here\'s what each file in the template does.","source":"@site/modding-docs/project-structure.mdx","sourceDirName":".","slug":"/project-structure","permalink":"/modding-docs/project-structure","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"id":"project-structure","title":"Project Structure"},"sidebar":"docs","previous":{"title":"Getting Started","permalink":"/modding-docs/getting-started"},"next":{"title":"Common Patterns","permalink":"/modding-docs/common-patterns"}}');var i=t(6070),o=t(1753);const c={id:"project-structure",title:"Project Structure"},r=void 0,d={},a=[{value:"Key Files",id:"key-files",level:2},{value:"<code>manifest.json</code>",id:"manifest.json",level:3},{value:"<code>src/main.ts</code>",id:"main.ts",level:3},{value:"<code>src/ui/ExamplePanel.tsx</code>",id:"examplepanel.tsx",level:3},{value:"<code>src/types/react.ts</code>",id:"react.ts",level:3},{value:"<code>vite.config.ts</code>",id:"vite.config.ts",level:3},{value:"<code>tsconfig.json</code>",id:"tsconfig.json",level:3},{value:"<code>scripts/link.ts</code>",id:"link.ts",level:3},{value:"<code>scripts/run.ts</code>",id:"run.ts",level:3}];function l(e){const n={code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.p,{children:"Here's what each file in the template does."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"\u251c\u2500\u2500 src/\n\u2502   \u251c\u2500\u2500 main.ts               # Your mod's entry point\n\u2502   \u251c\u2500\u2500 ui/\n\u2502   \u2502   \u2514\u2500\u2500 ExamplePanel.tsx   # Example React component\n\u2502   \u2514\u2500\u2500 types/\n\u2502       \u251c\u2500\u2500 react.ts           # React shim (pulls React from game API)\n\u2502       \u251c\u2500\u2500 index.d.ts         # Re-exports + global Window declarations\n\u2502       \u251c\u2500\u2500 api.d.ts           # Main ModdingAPI interface\n\u2502       \u251c\u2500\u2500 core.d.ts          # Coordinate, BoundingBox, GameSpeed\n\u2502       \u251c\u2500\u2500 game-state.d.ts    # Station, Track, Train, Route types\n\u2502       \u251c\u2500\u2500 game-constants.d.ts# GameConstants, ConstructionCosts\n\u2502       \u251c\u2500\u2500 game-actions.d.ts  # Bond, BondType types\n\u2502       \u251c\u2500\u2500 build.d.ts         # Build automation types\n\u2502       \u251c\u2500\u2500 ui.d.ts            # UI placements & option types\n\u2502       \u251c\u2500\u2500 cities.d.ts        # City, CityConfig types\n\u2502       \u251c\u2500\u2500 trains.d.ts        # TrainTypeConfig, TrainTypeStats\n\u2502       \u251c\u2500\u2500 stations.d.ts      # StationTypeConfig\n\u2502       \u251c\u2500\u2500 map.d.ts           # Map sources, layers, overrides\n\u2502       \u251c\u2500\u2500 career.d.ts        # MissionConfig, StarConfig\n\u2502       \u251c\u2500\u2500 content-templates.d.ts # Newspaper & tweet templates\n\u2502       \u251c\u2500\u2500 pop-timing.d.ts    # CommuteTimeRange\n\u2502       \u251c\u2500\u2500 i18n.d.ts          # I18nAPI\n\u2502       \u251c\u2500\u2500 utils.d.ts         # RechartsComponents\n\u2502       \u251c\u2500\u2500 schemas.d.ts       # Zod validation schemas\n\u2502       \u251c\u2500\u2500 electron.d.ts      # ElectronAPI types\n\u2502       \u2514\u2500\u2500 manifest.d.ts      # ModManifest type\n\u251c\u2500\u2500 scripts/\n\u2502   \u251c\u2500\u2500 run.ts                 # Game launcher with logging\n\u2502   \u2514\u2500\u2500 link.ts                # Symlink management\n\u251c\u2500\u2500 manifest.json              # Mod metadata (loaded by the game)\n\u251c\u2500\u2500 vite.config.ts             # Build configuration\n\u251c\u2500\u2500 tsconfig.json              # TypeScript configuration\n\u2514\u2500\u2500 package.json               # Dependencies and scripts\n"})}),"\n",(0,i.jsx)(n.h2,{id:"key-files",children:"Key Files"}),"\n",(0,i.jsx)(n.h3,{id:"manifest.json",children:(0,i.jsx)(n.code,{children:"manifest.json"})}),"\n",(0,i.jsx)(n.p,{children:"The game reads this to identify your mod. Required fields:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "id": "com.author.modname",\n  "name": "My Mod",\n  "description": "Description of your mod",\n  "version": "1.0.0",\n  "author": { "name": "Your Name" },\n  "main": "index.js"\n}\n'})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"id"})," \u2014 unique identifier in reverse-domain notation"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"main"})," \u2014 always ",(0,i.jsx)(n.code,{children:'"index.js"'})," (the Vite build output)"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"main.ts",children:(0,i.jsx)(n.code,{children:"src/main.ts"})}),"\n",(0,i.jsx)(n.p,{children:"Your mod's entry point. This is where you register hooks, add UI elements, and set up your mod's\nlogic. The template comes with a working example:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"const api = window.SubwayBuilderAPI;\n\nif (!api) {\n  console.error('SubwayBuilderAPI not found!');\n} else {\n  let initialized = false;\n\n  api.hooks.onMapReady((_map) => {\n    if (initialized) return;\n    initialized = true;\n\n    // Set up your mod here\n    api.ui.addFloatingPanel({\n      id: 'my-mod-panel',\n      title: 'My Mod',\n      icon: 'Puzzle',\n      render: ExamplePanel,\n    });\n  });\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"examplepanel.tsx",children:(0,i.jsx)(n.code,{children:"src/ui/ExamplePanel.tsx"})}),"\n",(0,i.jsx)(n.p,{children:"A sample React component that demonstrates how to use game UI components and hooks inside a floating\npanel:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-tsx",children:'import { useState } from \'react\';\n\nconst api = window.SubwayBuilderAPI;\nconst { Button } = api.utils.components as Record<string, React.ComponentType<any>>;\n\nexport function ExamplePanel() {\n  const [count, setCount] = useState(0);\n\n  return (\n    <div className="flex flex-col gap-3 p-3">\n      <p className="text-sm text-muted-foreground">Click count: {count}</p>\n      <Button onClick={() => setCount((c) => c + 1)}>Increment</Button>\n    </div>\n  );\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"react.ts",children:(0,i.jsx)(n.code,{children:"src/types/react.ts"})}),"\n",(0,i.jsx)(n.p,{children:"The React shim. This is how JSX works in mods \u2014 instead of bundling React, the shim pulls React from\nthe game's API at runtime:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"const React = window.SubwayBuilderAPI.utils.React;\n\nexport default React;\nexport const { useState, useEffect, useCallback, useMemo, useRef /* ... */ } = React;\n\n// JSX runtime exports\nexport const jsx = React.createElement;\nexport const jsxs = React.createElement;\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Vite is configured to alias ",(0,i.jsx)(n.code,{children:"react"})," and ",(0,i.jsx)(n.code,{children:"react/jsx-runtime"})," imports to this file, so you can write\nstandard ",(0,i.jsx)(n.code,{children:"import { useState } from 'react'"})," and it just works."]}),"\n",(0,i.jsx)(n.h3,{id:"vite.config.ts",children:(0,i.jsx)(n.code,{children:"vite.config.ts"})}),"\n",(0,i.jsx)(n.p,{children:"The build configuration. Key points:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Output format"}),": IIFE (immediately-invoked function expression) \u2014 the game expects a single\nscript, not ES modules"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"React aliasing"}),": Routes ",(0,i.jsx)(n.code,{children:"react"})," imports through the shim"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Static copy"}),": Copies ",(0,i.jsx)(n.code,{children:"manifest.json"})," into ",(0,i.jsx)(n.code,{children:"dist/"})," alongside the built JS"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"No minification"}),": Keeps the output readable for debugging"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"tsconfig.json",children:(0,i.jsx)(n.code,{children:"tsconfig.json"})}),"\n",(0,i.jsx)(n.p,{children:"Standard TypeScript config with:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"strict: true"})," \u2014 full type safety"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:'jsx: "react-jsx"'})," \u2014 automatic JSX transform"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"noEmit: true"})," \u2014 TypeScript is only used for type checking, Vite handles the actual build"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"link.ts",children:(0,i.jsx)(n.code,{children:"scripts/link.ts"})}),"\n",(0,i.jsxs)(n.p,{children:["Creates a symlink from ",(0,i.jsx)(n.code,{children:"dist/"})," to the game's mods folder. It reads the mod ID from ",(0,i.jsx)(n.code,{children:"manifest.json"}),"\nand uses the last segment as the folder name (e.g., ",(0,i.jsx)(n.code,{children:"com.author.mymod"})," becomes ",(0,i.jsx)(n.code,{children:"mymod/"}),")."]}),"\n",(0,i.jsx)(n.h3,{id:"run.ts",children:(0,i.jsx)(n.code,{children:"scripts/run.ts"})}),"\n",(0,i.jsxs)(n.p,{children:["Finds the Subway Builder executable on your system and launches it with ",(0,i.jsx)(n.code,{children:"ELECTRON_ENABLE_LOGGING=1"}),".\nCaptures stdout/stderr to ",(0,i.jsx)(n.code,{children:"debug/latest.log"})," so you can review console output after the session."]})]})}function u(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},1753(e,n,t){t.d(n,{R:()=>c,x:()=>r});var s=t(758);const i={},o=s.createContext(i);function c(e){const n=s.useContext(o);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:c(e.components),s.createElement(o.Provider,{value:n},e.children)}}}]);