---
id: map-porting-guide
title: Guida al Porting delle Mappe
---

Questa guida è per tutte le mappe create prima della versione 1.0.0 e del rilascio dell'API di modding, come il [Pack Australia/Nuova Zelanda di expedtadam](https://drive.google.com/drive/folders/18fpT9ASi3kMIK0lYjOzAbb-IM_RPZ6cz). Richiede un po' più di configurazione, ma può comunque essere portata nel nuovo framework abbastanza facilmente.

### Passo 1 - Installazione del Map Manager
Scarica l'ultima versione del Map Manager da https://github.com/Kronifer/subwaybuilder-patcher/releases. Per scaricare, clicca sulla versione corrispondente al tuo sistema operativo.

<img width="1000" alt="image" src="https://github.com/user-attachments/assets/4bc7b27d-9868-475f-9a4a-5ce447a77036" />

:::note
Per Windows, prendi il file `.exe`. Per Linux, il file `.zip`. Per MacOS, usa `arm64.dmg` se il tuo Mac ha un chip Apple Silicon (es. M1, M2, M3, ecc.) e `x64.dmg` se il tuo Mac ha un chip Intel. In generale, i Mac successivi al 2021 tendono ad avere chip Apple Silicon, mentre i modelli più vecchi chip Intel, ma verifica sempre.
:::

:::note
Su MacOS, l'installer .dmg potrebbe essere messo in quarantena. Per eseguirlo, apri un terminale nella cartella dove hai scaricato l'installer e esegui `xattr -d com.apple.quarantine {INSTALLER_FILENAME}`. Ad esempio, scaricando la versione 0.2.7 per Mac ARM, esegui `xattr -d com.apple.quarantine Subway.Builder.Map.Manager-0.2.7-arm64.dmg`.
:::

Dopo, installa l'app come faresti normalmente. Una volta completato l'installer, avvia l'app e segui la configurazione. A questo punto è sicuro eliminare lo ZIP, l'installer e qualsiasi altro file scaricato.

### Passo 2 - Estrazione dei File
Ora dobbiamo estrarre i file necessari dalla mappa scaricata. Abbiamo bisogno di 6 file in totale:
 - `XXX.pmtiles` (`XXX` è il codice della tua città; es. `MIA` per Miami)
 - `demand_data.json`
 - `buildings_index.json`
 - `roads.geojson`
 - `runways_taxiways.geojson`
 - `config.json`

Il primo è semplice. Cerca il file `XXX.pmtiles` nella mappa scaricata. Si trova da qualche parte nella directory, alla radice o in una cartella. Per ora, crea una cartella di lavoro temporanea per i 6 file.

Gli altri 4 richiedono più lavoro. Sono compressi (`.gz`). Dobbiamo estrarli.

:::important
Se i tuoi 4 file sono `.gz` (es. `demand_data.json.gz`), continua a leggere e segui i passaggi. Se non lo sono (es. `demand_data.json`), spostali nella cartella temporanea e passa al Passo 3. Se i 4 file mancano, la mappa è incompleta. Puoi [generare i dati da solo](https://github.com/kaicardenas0618/Subway-Builder-Map-Directory/wiki/Creating-a-Custom-Map) o trovare un'altra mappa.
:::

:::tip
Su Windows e Linux puoi usare [7-Zip](https://www.7-zip.org/download.html) per estrarre `.gz`. MacOS supporta nativamente gzip; basta cliccare per estrarre.
:::

All'interno vedrai un unico file. Ad esempio, dentro `demand_data.json.gz` troverai `demand_data.json`. Fai lo stesso per gli altri 3 file e mettili nella cartella temporanea. Alcune mappe hanno file duplicati; non importa quale scegliere.

### Passo 3 - Creazione del Config
L'ultimo file necessario è `config.json`. Questo è il più complesso. Crea un nuovo file chiamato `config.json`.

:::tip
Assicurati sia `.json`. Cerca su Google come abilitare le estensioni dei file se necessario.
:::

Dentro `config.json`, incolla questo modello:
```
{
    "name": "Boise",
    "code": "BOI",
    "description": "Build a rapid transit network for one of America`s fastest growing cities.",
    "population": 329866,
    "initialViewState": {
        "zoom": 13,
        "latitude": 43.617499,
        "longitude": -116.245394,
        "bearing": 0
    },
    "creator": "muffintime",
    "version": "2.1.0"
}
```

Modifica questi dati per la tua mappa. Cerca un file `.js` nella directory (spesso `index.js`, `main.js` o `config.js`).

<img width="1097" height="402" alt="image" src="https://github.com/user-attachments/assets/b25a1577-badf-4adf-a414-d76003c3a26d" />

> Questo si trova in `index.js` del Pack delle Città Canadesi.

:::tip
Se ci sono più `.js`, controllali tutti; uno contiene i dati necessari.
:::

Da questo file otteniamo:
 - `name`
 - `code`
 - `description`
 - `population`
 - `initialViewState` (e tutti i suoi parametri)

:::note
Se non c'è `initialViewState`, metti 12 o 13 per `zoom` e 0 per `bearing`. Per `latitude` e `longitude`, scegli un valore qualsiasi all'interno del bbox. Nell'esempio di Toronto possiamo usare 44.0 e -79.0.
:::

Gli ultimi due dati necessari sono `creator` e `version`. Non presenti nel pack, ma richiesti. Usa il `creator` indicato sulla [pagina di download](https://github.com/kaicardenas0618/Subway-Builder-Map-Directory/wiki/Map-Directory). Metti qualsiasi valore per `version`. Una volta pronti tutti e 6 i file, continua.

:::important
Non obbligatorio, ma se vuoi condividere la mappa portata, includi il `creator` per dare credito agli autori originali.
:::

### Passo 4 - Comprimere i File
Ora che abbiamo tutti i 6 file, mettili in un `.zip`. Questo si può fare nativamente su Windows, Linux, MacOS (`Compress`) o con [7-Zip](https://www.7-zip.org/download.html). Una volta creato il `.zip`, il porting è quasi completo e resta solo importarlo nel gioco.

### Passo 5 - Aggiungere la Mappa
Per installare una mappa, clicca su `ADD A MAP` e importa lo ZIP. Il nome della mappa, il creatore e la versione appariranno.

<img width="1200" alt="image" src="https://github.com/user-attachments/assets/c258cf39-c211-4677-8ac1-0828a97d5c61" />

Dopo aver importato tutte le mappe, clicca su `GENERATE MOD`. Questo aggiunge automaticamente le mappe a Subway Builder e registra il Map Manager come mod.

Se vuoi aggiungere un'altra mappa dopo, riapri Map Manager e importa tutte le mappe desiderate (anche quelle già presenti). Clicca `GENERATE MOD` e saranno aggiunte automaticamente. Se non reinserisci le vecchie mappe, saranno rimosse.

### Passo 6 - Avviare Subway Builder
Dopo aver aggiunto tutte le mappe e generato il mod, avvia il gioco con `START GAME`. D’ora in poi userai sempre questo metodo. In gioco, le mappe appariranno nella scheda `CUSTOM` pronte per giocare.

:::important
A causa del funzionamento attuale del gioco, devi avviarlo tramite Map Manager affinché edifici e acqua siano visibili.
:::
