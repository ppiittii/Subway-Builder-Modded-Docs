---
id: legacy-map-installation-guide
title: Guida all’installazione delle mappe (Legacy)
---

Prima dello sviluppo del Map Manager, veniva utilizzato il metodo `serve`. Era più complesso e variava da mappa a mappa, ma possiamo facilmente estrarre i file necessari e portare la mappa nel Map Manager.

### Passaggio 1 - Installare il Map Manager
Scarica l’ultima versione del Map Manager da https://github.com/Kronifer/subwaybuilder-patcher/releases. Per scaricarla, clicca sulla versione che corrisponde al tuo sistema operativo.

<img width="1000" alt="image" src="/images/map-manager-download.png" />

:::note
Per Windows, devi scaricare il file `.exe`. Per Linux, il file `.zip`. Per MacOS, usa il file `arm64.dmg` se il tuo Mac ha un chip Apple Silicon (ad esempio M1, M2, M3, ecc.) e il file `x64.dmg` se il tuo Mac ha un chip Intel. Come regola generale, i Mac prodotti dopo il 2021 circa tendono ad avere chip Apple Silicon, mentre i modelli più vecchi tendono ad avere chip Intel, ma verifica perché esistono eccezioni.
:::

:::note
Su MacOS, il programma di installazione `.dmg` sarà probabilmente messo in quarantena. Per eseguirlo, apri un terminale nella cartella in cui hai scaricato il file e poi esegui `xattr -d com.apple.quarantine {INSTALLER_FILENAME}`. Ad esempio, scaricando la versione 0.2.7 per un Mac ARM, dovresti eseguire `xattr -d com.apple.quarantine Subway.Builder.Map.Manager-0.2.7-arm64.dmg`.

Inoltre, la cartella Library che contiene la cartella metro-maker4 potrebbe essere nascosta per impostazione predefinita. Per risolvere il problema, apri Finder e vai alla cartella Home, poi seleziona View -> Show View Options -> Show Library Folder. 
:::

Dopodiché, installa l’app come faresti normalmente con qualsiasi altra applicazione. Una volta completata l’installazione, avvia l’app e segui la procedura di configurazione selezionando la posizione dell’eseguibile del gioco e la cartella `metro-maker4`. A questo punto puoi eliminare il file ZIP, il programma di installazione e qualsiasi altro file scaricato.

<img width="1200" alt="image" src="/images/map-manager-welcome.png" />

### Passaggio 2 - Estrarre i file
Ora dobbiamo estrarre i file necessari dalla mappa che hai scaricato. In totale ci serviranno 6 file:
 - `XXX.pmtiles` (`XXX` è il codice della tua città; ad esempio `MIA` per Miami)
 - `demand_data.json`
 - `buildings_index.json`
 - `roads.geojson`
 - `runways_taxiways.geojson`
 - `config.json`

Il primo è semplice. Nella mappa che hai scaricato, cerca il file XXX.pmtiles. Si trova da qualche parte nella directory, nella cartella principale oppure in una sottocartella. Per ora, crea una cartella di lavoro temporanea in cui salvare i 6 file.

I successivi 4 richiedono un po’ più di lavoro. Dovresti riuscire a trovarli abbastanza facilmente, tuttavia sono tutti in formato compresso (terminano con `.gz`). Per questo, dobbiamo estrarli come archivio.

:::tip
Su Windows e Linux puoi usare [7-Zip](https://www.7-zip.org/download.html) per estrarre l’archivio `.gz`. MacOS supporta nativamente l’estrazione degli archivi gzip, quindi puoi semplicemente fare clic su di esso per estrarlo.
:::

All’interno dovresti vedere un singolo file. Se apri l’archivio `demand_data.json.gz`, dovresti trovare `demand_data.json` al suo interno, e lo stesso vale per gli altri 3 archivi. Estrai tutti e 4 questi file e inseriscili nella cartella di lavoro temporanea. Alcune mappe contengono file di dati duplicati nella directory. Non importa quale scegli, sono tutti uguali.

L’ultimo file di cui abbiamo bisogno è `config.json`. Questo è il più difficile. Per farlo, ci servono alcune informazioni. Per prima cosa, crea un nuovo file e chiamalo `config.json`.

:::tip
Assicurati che sia un file `.json`. Cerca online come abilitare le estensioni dei nomi dei file nel tuo sistema operativo se il tipo di file non indica `JSON File`.
:::

All’interno di `config.json`, incolla questo modello:
```
{
  "name": "Boise",
  "code": "BOI",
  "description": "Build a rapid transit network for one of America`s fastest growing cities.",
  "population": 329866,
  "initialViewState": {
    "zoom": 13,
    "latitude": 43.617499,
    "longitude": -116.245394,
    "bearing": 0
  },
  "creator": "muffintime",
  "version": "2.1.0"
}
```

Dobbiamo modificare questi dati affinché corrispondano alla nostra mappa. Nella directory della tua mappa dovrebbe esserci un file `.js`, generalmente `index.js`. All’interno di quel file vedrai qualcosa di molto simile al nostro modello.

<img width="1097" height="402" alt="image" src="/images/city-data.png" />

> Questo si trova nel file `index.js` del Canadian Cities Map Pack.

:::tip
Se nella directory sono presenti più file `.js`, controllali tutti. Uno di essi contiene i dati di cui hai bisogno.
:::

Da questo file possiamo ottenere:
 - `name`
 - `code`
 - `description`
 - `population`
 - `intialViewState` (e tutti i suoi parametri)

:::note
Se i tuoi dati non includono `initialViewState`, puoi impostare 12 o 13 per `zoom` e 0 per `bearing`. Per `latitude` e `longitude`, puoi scegliere qualsiasi numero all’interno dell’intervallo di coordinate del tuo bbox (la `latitude` corrisponde al **2°** e **4°** numero, mentre la `longitude` corrisponde al **1°** e **3°**). Nell’esempio di Toronto mostrato sopra, potremmo usare 44.0 e -79.0 rispettivamente per `latitude` e `longitude`.
:::

Le ultime 2 informazioni di cui abbiamo bisogno, `creator` e `version`, si trovano entrambe in `manifest.json`, che ogni progetto possiede. Una volta ottenuto tutto il necessario per il tuo `config.json`, assicurati di avere tutti e 6 i file. Dopodiché, sei pronto per passare al passaggio successivo.

:::important
Sebbene non sia obbligatorio, se prevedi di condividere questa mappa convertita, includi il `creator`. In questo modo i creatori originali continueranno a ricevere il merito per le mappe che hanno realizzato.
:::

### Passaggio 3 - Creare il file ZIP
Ora che abbiamo tutti e 6 i file, dobbiamo comprimerli in un file `.zip`. Questo può essere fatto facilmente su Windows o Linux in modo nativo o utilizzando [7-Zip](https://www.7-zip.org/download.html), oppure su MacOS selezionando `Compress`. Una volta ottenuto il file `.zip`, hai praticamente completato la conversione della mod e non resta che importarla nel gioco per poterla utilizzare.

### Passaggio 4 - Aggiungere la mappa

Per installare una mappa, fai semplicemente clic sul pulsante `ADD A MAP` e importa il file ZIP che hai scaricato contenente la tua mappa. Una volta completata l’operazione, dovresti vedere sullo schermo il nome della mappa, il creatore e la versione.

<img width="1200" alt="image" src="/images/map-manager-home.png" />

### Passaggio 5 - Avviare Subway Builder

Una volta aggiunte tutte le tue mappe, puoi avviare il gioco utilizzando `START GAME`. D’ora in poi, il gioco dovrà essere avviato in questo modo. All’interno del gioco, le tue mappe appariranno nella scheda `CUSTOM` e saranno pronte per essere giocate!

:::important
A causa del funzionamento attuale del gioco, devi avviarlo tramite il Map Manager ogni volta che vuoi giocare a una mappa personalizzata. Se non avvii il gioco tramite il Map Manager, edifici e acqua non appariranno nel gioco.
:::
