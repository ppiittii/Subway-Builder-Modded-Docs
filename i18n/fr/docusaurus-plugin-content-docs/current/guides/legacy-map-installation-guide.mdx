---
id: legacy-map-installation-guide
title: Guide d'installation des cartes (Legacy)
---

Avant le développement du Map Manager, la méthode `serve` était utilisée. Elle était plus complexe et variait d’une carte à l’autre, mais nous pouvons facilement extraire les fichiers nécessaires et porter la carte vers le Map Manager.

### Étape 1 - Installation du Map Manager
Téléchargez la dernière version du Map Manager à l’adresse https://github.com/Kronifer/subwaybuilder-patcher/releases. Pour télécharger, cliquez sur la version correspondant à votre système d’exploitation.

<img width="1000" alt="image" src="https://github.com/user-attachments/assets/4bc7b27d-9868-475f-9a4a-5ce447a77036" />

:::note
Sous Windows, vous avez besoin du fichier `.exe`. Sous Linux, vous avez besoin du fichier `.zip`. Sous MacOS, utilisez le fichier `arm64.dmg` si votre Mac possède une puce Apple Silicon (par exemple M1, M2, M3, etc.) et le fichier `x64.dmg` si votre Mac possède une puce Intel. En règle générale, les Macs plus récents que 2021 environ disposent de puces Apple Silicon et les modèles plus anciens disposent de puces Intel, mais vérifiez car il existe des exceptions.
:::

:::note
Sous MacOS, l’installateur .dmg sera probablement mis en quarantaine. Pour l’exécuter, ouvrez un terminal dans le dossier où vous avez téléchargé l’installateur, puis exécutez `xattr -d com.apple.quarantine {INSTALLER_FILENAME}`. Par exemple, lors du téléchargement de la version 0.2.7 pour un Mac ARM, vous devrez exécuter `xattr -d com.apple.quarantine Subway.Builder.Map.Manager-0.2.7-arm64.dmg`.
:::

Ensuite, installez l’application comme n’importe quelle autre application. Une fois l’installation terminée, lancez l’application et suivez le processus de configuration. À ce stade, vous pouvez supprimer le fichier ZIP, l’installateur et tous les autres fichiers téléchargés.

### Étape 2 - Extraction des fichiers
Nous devons maintenant extraire les fichiers nécessaires à partir de la carte que vous avez téléchargée. Nous aurons besoin de 6 fichiers au total :
 - `XXX.pmtiles` (`XXX` est le code de votre ville ; par exemple `MIA` pour Miami)
 - `demand_data.json`
 - `buildings_index.json`
 - `roads.geojson`
 - `runways_taxiways.geojson`
 - `config.json`

Le premier est simple. Dans la carte que vous avez téléchargée, recherchez le fichier XXX.pmtiles. Il se trouve quelque part dans le répertoire, soit à la racine soit dans un dossier. Pour l’instant, créez un dossier de travail temporaire afin d’y stocker nos 6 fichiers.

Les 4 suivants demandent un peu plus de travail. Vous devriez pouvoir les trouver relativement facilement, mais ils sont tous sous forme compressée (ils se terminent par `.gz`). Pour cela, nous devrons les extraire comme une archive.

:::tip
Sous Windows et Linux, vous pouvez utiliser [7-Zip](https://www.7-zip.org/download.html) pour extraire l’archive `.gz`. MacOS prend en charge nativement la décompression des archives gzip, ce qui signifie que vous pouvez simplement cliquer dessus pour l’extraire.
:::

À l’intérieur, vous devriez voir un seul fichier. Si vous êtes dans l’archive `demand_data.json.gz`, vous devriez voir `demand_data.json` à l’intérieur, et il en va de même pour les 3 autres archives. Extrayez ces 4 fichiers et placez-les dans notre dossier de travail temporaire. Certaines cartes contiennent des fichiers de données en double dans leur répertoire. Peu importe lequel vous choisissez, car ils sont identiques.

Le dernier fichier dont nous avons besoin est `config.json`. C’est le plus difficile. Pour cela, nous avons besoin de plusieurs éléments. Tout d’abord, créez un nouveau fichier et nommez-le `config.json`.

:::tip
Assurez-vous qu’il s’agit bien d’un fichier `.json`. Recherchez comment activer les extensions de noms de fichiers sur votre système d’exploitation si le type de fichier n’indique pas `JSON File`.
:::

À l’intérieur de `config.json`, collez ce modèle :
```
{
   "name": "Boise",
   "code": "BOI",
   "description": "Build a rapid transit network for one of America`s fastest growing cities.",
   "population": 329866,
   "initialViewState": {
    "zoom": 13,
    "latitude": 43.617499,
    "longitude": -116.245394,
    "bearing": 0
  },
  "creator": "muffintime",
  "version": "2.1.0"
}
```


Nous devons modifier ces données afin qu’elles correspondent à notre carte. Dans le répertoire de votre carte, il devrait y avoir un fichier `.js`, le plus souvent `index.js`. À l’intérieur de ce fichier, vous verrez quelque chose de très similaire à notre modèle.

<img width="1097" height="402" alt="image" src="https://github.com/user-attachments/assets/b25a1577-badf-4adf-a414-d76003c3a26d" />

> Ceci se trouve dans le fichier `index.js` du Canadian Cities Map Pack.

:::tip
Si votre répertoire contient plusieurs fichiers `.js`, vérifiez-les tous. L’un d’eux contient les données dont vous avez besoin.
:::

À partir de ce fichier, nous pouvons obtenir :
 - `name`
 - `code`
 - `description`
 - `population`
 - `intialViewState` (et tous ses arguments)

:::note
Si vos données n’incluent pas `initialViewState`, vous pouvez mettre 12 ou 13 pour `zoom` et 0 pour `bearing`. Pour `latitude` et `longitude`, vous pouvez choisir n’importe quelle valeur dans votre plage de coordonnées bbox (la `latitude` correspond aux **2e** et **4e** nombres et la `longitude` correspond aux **1er** et **3e**). Dans l’exemple de Toronto ci-dessus, nous pourrions utiliser 44.0 et -79.0 pour `latitude` et `longitude` respectivement.
:::

Les 2 derniers éléments dont nous avons besoin, `creator` et `version`, se trouvent dans `manifest.json`, que chaque projet possède. Une fois que vous avez tout ce dont vous avez besoin pour votre config.json, assurez-vous d’avoir les 6 fichiers. Ensuite, vous êtes prêt à passer à l’étape suivante.

:::important
Bien que ce ne soit pas obligatoire, si vous prévoyez de partager cette carte portée, veuillez inclure le `creator`. Cela garantit que les créateurs originaux reçoivent toujours le crédit pour les cartes qu’ils ont réalisées.
:::

### Étape 3 - Compression des fichiers
Maintenant que nous avons les 6 fichiers, nous devons les regrouper dans un fichier `.zip`. Cela peut facilement être fait sous Windows ou Linux nativement ou en utilisant [7-Zip](https://www.7-zip.org/download.html), ou sous MacOS en sélectionnant `Compress`. Une fois que vous avez un fichier `.zip`, vous avez essentiellement terminé le portage du mod et il ne vous reste plus qu’à l’importer dans le jeu pour y jouer.

### Étape 4 - Ajouter la carte

Pour installer une carte, cliquez simplement sur le bouton `ADD A MAP` et importez le fichier ZIP contenant votre carte. Une fois terminé, vous devriez voir apparaître le nom de la carte, le créateur et la version à l’écran.

<img width="1200" alt="image" src="https://github.com/user-attachments/assets/c258cf39-c211-4677-8ac1-0828a97d5c61" />

Une fois que vous avez importé toutes les cartes que vous souhaitez ajouter au jeu, cliquez sur le bouton `GENERATE MOD`. Cela ajoute automatiquement les cartes à Subway Builder et enregistre le Map Manager comme mod dans votre jeu.\

Si vous souhaitez ajouter une autre carte après avoir déjà généré le mod, relancez le Map Manager et importez toutes les cartes que vous souhaitez dans votre jeu (y compris celles déjà présentes). Cliquez sur `GENERATE MOD` et le Map Manager ajoutera automatiquement les cartes à Subway Builder. Si vous ne réajoutez pas les anciennes cartes, elles seront supprimées de votre jeu.

### Étape 5 - Lancer Subway Builder

Une fois que vous avez ajouté toutes vos cartes et généré le mod, vous pouvez lancer le jeu en utilisant `START GAME`. C’est ainsi que vous devrez désormais lancer le jeu. En jeu, vos cartes apparaîtront dans l’onglet `CUSTOM` et seront prêtes à être jouées !

:::important
En raison du fonctionnement actuel du jeu, vous devez lancer le jeu via le Map Manager chaque fois que vous souhaitez jouer à une carte personnalisée. Si vous ne lancez pas le jeu à l’aide du Map Manager, les bâtiments et l’eau n’apparaîtront pas en jeu.
:::
