---
id: map-porting-guide
title: Anleitung zum Portieren von Karten
---

Diese Anleitung richtet sich an alle Karten, die vor Version 1.0.0 und der Veröffentlichung der Modding-API erstellt wurden, wie das [Australia/New Zealand Pack von expedtadam](https://drive.google.com/drive/folders/18fpT9ASi3kMIK0lYjOzAbb-IM_RPZ6cz). Es erfordert etwas mehr Einrichtung, kann aber relativ einfach auf das neue Framework portiert werden.

### Schritt 1 - Installation des Map Managers
Lade die neueste Version des Map Managers herunter: https://github.com/Kronifer/subwaybuilder-patcher/releases. Klicke auf die Version, die deinem Betriebssystem entspricht.

<img width="1000" alt="image" src="/images/map-manager-download.png" />

:::note
Für Windows benötigst du die `.exe`-Datei. Für Linux die `.zip`-Datei. Für macOS verwende die `arm64.dmg`, wenn dein Mac einen Apple-Silicon-Chip hat (z. B. M1, M2, M3 usw.), und die `x64.dmg`, wenn dein Mac einen Intel-Chip hat. Als Faustregel gilt: Macs ab etwa 2021 haben meist Apple Silicon, ältere Modelle Intel, überprüfe es aber sicherheitshalber.
:::

:::note
Unter macOS wird der `.dmg`-Installer wahrscheinlich in Quarantäne gesetzt. Um ihn auszuführen, öffne ein Terminal im Ordner, in dem du den Installer heruntergeladen hast, und führe `xattr -d com.apple.quarantine {INSTALLER_FILENAME}` aus. Beispielsweise für Version 0.2.7 auf einem ARM-Mac: `xattr -d com.apple.quarantine Subway.Builder.Map.Manager-0.2.7-arm64.dmg`.

Außerdem kann der Library-Ordner, der den Ordner `metro-maker4` enthält, standardmäßig ausgeblendet sein. Um ihn sichtbar zu machen, öffne den Finder, gehe zum Home-Ordner und wähle Ansicht → Darstellung Optionen → Library-Ordner anzeigen.
:::

Installiere danach die App wie jede andere App auch. Nach Abschluss der Installation starte die App und folge dem Setup-Prozess, wähle den Speicherort deiner Spiel-Executable und den Ordner `metro-maker4`. Danach kannst du die ZIP-Datei, den Installer und alle anderen heruntergeladenen Dateien löschen.

<img width="1200" alt="image" src="https://private-user-images.githubusercontent.com/19807509/553076498-ea9604c2-bc93-4cb4-939c-73d957b22f2a.png?jwt=..." />

### Schritt 2 - Dateien extrahieren
Nun müssen wir die benötigten Dateien aus der heruntergeladenen Karte extrahieren. Insgesamt werden 6 Dateien benötigt:
 - `XXX.pmtiles` (`XXX` ist dein Stadtkürzel, z. B. `MIA` für Miami)
 - `demand_data.json`
 - `buildings_index.json`
 - `roads.geojson`
 - `runways_taxiways.geojson`
 - `config.json`

Die erste Datei ist einfach. Suche im Kartenordner nach der Datei `XXX.pmtiles`. Sie befindet sich entweder im Hauptverzeichnis oder in einem Unterordner. Erstelle vorübergehend einen Arbeitsordner, um alle 6 Dateien abzulegen.

Die nächsten 4 Dateien erfordern etwas mehr Arbeit. Du solltest sie leicht finden können, aber sie sind alle komprimiert (Endung `.gz`). Wir müssen sie als Archiv extrahieren.

:::important
Wenn deine 4 Dateien `.gz` sind (z. B. `demand_data.json.gz`), lies weiter und folge den nächsten Anweisungen. Wenn die Dateien keine `.gz`-Dateien sind (z. B. `demand_data.json`), überspringe den Rest dieses Schritts, verschiebe die Dateien in den Arbeitsordner und fahre mit Schritt 3 fort. Wenn die 4 Dateien fehlen, ist die heruntergeladene Karte unvollständig. Du kannst entweder [die Daten selbst generieren](https://github.com/kaicardenas0618/Subway-Builder-Map-Directory/wiki/Creating-a-Custom-Map) oder eine andere Karte finden.
:::

:::tip
Unter Windows und Linux kannst du [7-Zip](https://www.7-zip.org/download.html) verwenden, um die `.gz`-Archive zu entpacken. macOS unterstützt gzip-Archive nativ, du kannst also einfach doppelklicken.
:::

Im Archiv solltest du nur eine Datei sehen. Im `demand_data.json.gz`-Archiv findest du z. B. `demand_data.json`, dasselbe gilt für die anderen 3 Archive. Extrahiere alle 4 Dateien und lege sie in deinen temporären Arbeitsordner. Manche Karten enthalten doppelte Datenfiles, es ist egal, welche du nimmst, sie sind identisch.

### Schritt 3 - Config-Datei erstellen
Die letzte benötigte Datei ist `config.json`. Dies ist die komplizierteste. Erstelle zunächst eine neue Datei mit dem Namen `config.json`.

:::tip
Stelle sicher, dass es eine `.json`-Datei ist. Wenn die Dateiendung nicht angezeigt wird, suche, wie man die Anzeige von Dateiendungen auf deinem System aktiviert.
:::

Füge diese Vorlage in `config.json` ein:
```
{
  "name": "Boise",
  "code": "BOI",
  "description": "Build a rapid transit network for one of America`s fastest growing cities.",
  "population": 329866,
  "initialViewState": {
    "zoom": 13,
    "latitude": 43.617499,
    "longitude": -116.245394,
    "bearing": 0
  },
  "creator": "muffintime",
  "version": "2.1.0"
}
```

Bearbeite diese Daten so, dass sie zu deiner Karte passen. Im Verzeichnis der Karte sollte sich eine `.js`-Datei befinden, meist `index.js`, `main.js` oder `config.js`, aber sie kann auch anders heißen.

<img width="1097" height="402" alt="image" src="/images/city-data.png" />

> Beispiel aus der Datei `index.js` des Canadian Cities Map Packs.

:::tip
Wenn mehrere `.js`-Dateien vorhanden sind, überprüfe sie alle. Eine enthält die benötigten Daten.
:::

Von dieser Datei benötigen wir:
 - `name`
 - `code`
 - `description`
 - `population`
 - `initialViewState` (inklusive aller Parameter)

:::note
Wenn deine Daten kein `initialViewState` enthalten, kannst du für `zoom` 12 oder 13 und für `bearing` 0 verwenden. Für `latitude` und `longitude` wähle Werte innerhalb der Bounding-Box (Latitude = **2.** und **4.** Zahl, Longitude = **1.** und **3.** Zahl). Im Toronto-Beispiel oben könnten wir 44.0 und -79.0 verwenden.
:::

Die letzten beiden benötigten Angaben sind `creator` und `version`. Diese Daten sind im Pack nicht vorhanden, werden aber benötigt. Du kannst den `creator` von der [Download-Seite](https://github.com/kaicardenas0618/Subway-Builder-Map-Directory/wiki/Map-Directory) verwenden. Für `version` kannst du einen beliebigen Wert eintragen. Sobald du alle Daten hast, überprüfe, dass alle 6 Dateien vorhanden sind. Danach bist du bereit für den nächsten Schritt.

:::important
Es ist nicht zwingend, aber wenn du die portierte Karte teilen möchtest, solltest du den `creator` angeben, damit die ursprünglichen Autoren Anerkennung erhalten.
:::

### Schritt 4 - Dateien zippen
Jetzt, da wir alle 6 Dateien haben, müssen wir sie in ein `.zip`-Archiv packen. Unter Windows oder Linux geht das nativ oder mit [7-Zip](https://www.7-zip.org/download.html), unter macOS über „Komprimieren“. Sobald die `.zip`-Datei erstellt ist, ist der Port abgeschlossen, und du musst sie nur noch ins Spiel importieren.

### Schritt 5 - Karte hinzufügen

Um eine Karte zu installieren, klicke auf `ADD A MAP` und importiere die ZIP-Datei mit deiner Karte. Danach sollten Name, Creator und Version auf dem Bildschirm erscheinen.

<img width="1200" alt="image" src="https://private-user-images.githubusercontent.com/19807509/553076477-c08ebbab-5ce3-41d5-b713-b8050d2a51bf.png?jwt=..." />

### Schritt 6 - Subway Builder starten

Nachdem du alle Karten hinzugefügt hast, kannst du das Spiel über `START GAME` starten. Ab jetzt startest du das Spiel immer auf diese Weise. Im Spiel erscheinen deine Karten unter dem Tab `CUSTOM` und sind spielbereit.

:::important
Aufgrund der aktuellen Funktionsweise des Spiels musst du das Spiel über den Map Manager starten, um eine benutzerdefinierte Karte zu spielen. Wenn du das Spiel nicht über den Map Manager startest, erscheinen Gebäude und Wasser nicht im Spiel.
:::
